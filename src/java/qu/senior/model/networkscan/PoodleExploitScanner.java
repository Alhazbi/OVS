/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package qu.senior.model.networkscan;

import qu.senior.model.common.common;

   
public class PoodleExploitScanner extends Scanner {
common c = new common();

/*
for ip in `awk '{print $1}' < allexternal.txt`; do
    if gtimeout 30 openssl s_client -connect $ip:443 -ssl3 | grep -q 'Protocol  : SSLv3' ; then
        echo $ip SSLv3 detected >> sslv3output;
    else
        echo $ip SSLv3 NOT detected >> sslv3output;
    fi;
done
 echo 'QUIT' | openssl s_client -connect $ip:443 -ssl3 | grep -q 'Protocol : SSLv3'
 echo "QUIT"|openssl s_client -connect google.com:443 -ssl3  2>&1|grep 'Verify return code: 19' || echo safe
*/
   
@Override
    public boolean checkExploit(String ip) throws Exception {
        String out = c.executeCommand("echo \"QUIT\"|openssl s_client -connect "+ip+":443 -ssl3");
        return !(out.contains("connect:errno=111") || out.contains("connect:errno=0") ||  out.contains("Verify return code: 10") || out.contains("Verify return code: 0") || out.contains(""));
    }

    @Override
    public String getName() {
        return "Poodle SSLv3 Exploit";
    }

    @Override
    public int getPortNeeded() {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

}
